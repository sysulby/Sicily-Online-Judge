<% include util %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title>Sicily Online Judge</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--
    <link href="<%- lib('semantic-ui/2.4.1/semantic.min.css') %>" rel="stylesheet">
    <link href="<%- selfLib('tomorrow.css') %>" rel="stylesheet">
    <link href="<%- selfLib('math.css') %>" rel="stylesheet">
    <link href="<%- selfLib('style.css') %>?20181212" rel="stylesheet">
    <link href="<%- lib('morris.js/0.5.1/morris.css') %>" rel="stylesheet">
    -->
    <script data-cfasync="false" src="<%- lib('jquery/3.3.1/jquery.min.js') %>"></script>
    <link rel="shortcut icon" href="/sicily/images/favicon.ico" />
    <link type = "text/css" rel = "stylesheet" href="/sicily/css/global.css"/>
    <link type = "text/css" rel = "stylesheet" href="/sicily/css/style.css"/>
    <link type = "text/css" rel = "stylesheet" href="/sicily/css/sicilychan/static.css"/>
    <link type = "text/css" rel = "stylesheet" href="/sicily/css/project_hord.css"/>
    <link type = "text/css" rel = "stylesheet" href="/sicily/css/jquery-ui-1.8.6.custom.css"/>
    <script type="text/javascript" src="/sicily/js/jquery.min.js"></script>
    <script type="text/javascript" src="/sicily/js/jquery-ui-1.8.6.custom.min.js"></script>
    <script type="text/javascript" src="/sicily/js/nav.js"></script>
    <script type="text/javascript" src="/sicily/js/sicilychan/static.js"></script>
    <script type="text/javascript">var is_logged = <%= user != null %>;</script>
    <% if (useLocalLibs || !syzoj.config.google_fonts || !['like-google-fonts', 'like-local', 'built-in'].includes(syzoj.config.google_fonts.type)) { %>
      <link href="<%- syzoj.utils.makeUrl(['google-fonts', 'fira-mono.css']) %>" rel="stylesheet">
      <link href="<%- syzoj.utils.makeUrl(['google-fonts', 'lato.css']) %>" rel="stylesheet">
      <link href="<%- syzoj.utils.makeUrl(['google-fonts', 'open-sans.css']) %>" rel="stylesheet">
      <link href="<%- syzoj.utils.makeUrl(['google-fonts', 'exo-2.css']) %>" rel="stylesheet">
    <% } else if (syzoj.config.google_fonts.type === 'like-local') { %>
      <link href="<%- syzoj.config.google_fonts.url %>/google-fonts/fira-mono.css" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/google-fonts/lato.css" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/google-fonts/open-sans.css" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/google-fonts/exo-2.css" rel="stylesheet">
    <% } else if (syzoj.config.google_fonts.type === 'like-google-fonts') { %>
      <link href="<%- syzoj.config.google_fonts.url %>/css?family=Fira+Mono" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/css?family=Lato:400,700,400italic,700italic&subset=latin" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i&amp;subset=latin-ext" rel="stylesheet">
      <link href="<%- syzoj.config.google_fonts.url %>/css?family=Exo+2:600" rel="stylesheet">
    <% } else if (syzoj.config.google_fonts.type === 'built-in') { %>
      <link href="<%- this.builtInCdnUrl %>/google-fonts/fira-mono.css" rel="stylesheet">
      <link href="<%- this.builtInCdnUrl %>/google-fonts/lato.css" rel="stylesheet">
      <link href="<%- this.builtInCdnUrl %>/google-fonts/open-sans.css" rel="stylesheet">
      <link href="<%- this.builtInCdnUrl %>/google-fonts/exo-2.css" rel="stylesheet">
    <% } %>
    <% if (syzoj.config.google_analytics && syzoj.config.google_analytics !== 'UA-XXXXXXXX-X') { %>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', '<%= syzoj.config.google_analytics %>', 'auto');
      ga('send', 'pageview');

    </script>
    <% } %>
</head>
<body>
  <div id="msg-dialog" title="提示"></div>
  <div id="global_banner_container">
    <div id="global_banner">
      <div id="sicily_logo">
        <a href="/"><img src="<%= syzoj.config.logo.url %>" alt="Sicily"></a>
      </div>
      <div id="topbar">
      </div>
      <div id="loginbox">
        <% if (user) { %>
          <% if (user.is_show) { %>
            <a title="公开用户"><img src="/sicily/images/authorize2.gif" alt="公开用户" /></a>
          <% } else { %>
            <a title="隐藏用户"><img src="/sicily/images/authorize0.gif" alt="隐藏用户" /></a>
          <% } %>
          <a href="<%= syzoj.utils.makeUrl(['user', user.id]) %>" class="nickname">
            <%= user.username %><% if (user.nameplate) { %><%- user.nameplate %><% } %>
          </a>
          <% if (user.information) { %>
            <div id="signature"><%= user.information %></div>
          <% } else { %>
            <div id="signature">你还没有设置任何签名^_^</div>
          <% } %>
          <a href="/" href-post="<%= syzoj.utils.makeUrl(['logout'], { url: req.originalUrl }) %>">登出</a>
        <% } else { %>
          <% include login %>
          <form id="loginform" name="loginform">
            <div style="text-align: right">
              <div>
                <label for="username">用户名：</label>
                <input name="username" type="text" id="username" size="10" maxlength="30" />
                <label for="password">密码：</label>
                <input name="password" type="password" id="password" size="10" maxlength="16" />
                <button class="button_blue" onclick="login();return false;">登录</button>
              </div>
              <div id="msg">用户名或者密码错误</div>
              <div>
                <input id="lsession" name="lsession" type="checkbox" checked="1" />
                <label for="lsession">记住我的登录状态</label>
                | <a href="/sign_up" title="注册一个新的账号">注册账号</a>
                | <a href="<%= syzoj.utils.makeUrl(['forget']) %>" title="点击这里找回密码">忘记密码</a>
              </div>
            </div>
          </form>
        <% } %>
      </div>
    </div>
  </div>

  <div class="clear"></div>
  <% if (typeof contest !== 'undefined' && contest && contest.id) { %>
    <script type="text/javascript">
      var startTime = new Date(<%= contest.start_time %> * 1000);
      var endTime = new Date(<%= contest.end_time %> * 1000);
      var currentTime = new Date();
      var msg_pending = '比赛尚未开始';
      var msg_contestends = '比赛还剩 ';
      var msg_contestfinished = '比赛结束';
      var msg_months = ' 月 ';
      var msg_days = ' 天 ';
      var msg_hours = ' 小时 ';
      var msg_mins = ' 分钟 ';
      var msg_secs = ' 秒 ';
    </script>
    <script type="text/javascript" src="/sicily/js/contest.js"></script>
    <div id="contest_box">
      <h1 style="margin: 0px"><%= contest.title %></h1>
      <div id="contestClock"></div>
      <div id="hintClock"></div>
    </div>
    <script type="text/javascript">
      $("#topbar").append($("#contest_box"));
    </script>
  <% } else { %>
    <script>
      $(function () {
        $('.ui.search').search({
          debug: true,
          apiSettings: {
            url: '/api/v2/search/problems/{query}',
            cache: false
          },
          fields: {
            title: 'name'
          }
        });
      });
    </script>
    <div style="display:none">
      <div id="searchbox">
        <form action="<%= syzoj.utils.makeUrl(['problems', 'search']) %>" method="get" id="search_form">
          <div class="ui search">
            <input class="prompt search_bar" type="text" placeholder="搜索题目编号或者标题" name="keyword">
            <button class="button_blue" onclick="$(#search_form).submit();return false">搜索</button>
            <div class="results"></div>
          </div>
        </form>
      </div>
    </div>
    <script type="text/javascript">
      $("#topbar").append($("#searchbox"));
    </script>
  <% } %>

  <div class="topmenu-container">
    <div class="topmenu ui-corner-all">
      <ul>
        <li><a href="/">主页</a></li>
        <li><a href="/problems">题目</a></li>
        <li><a href="/contests">比赛</a></li>
        <li><a href="/contests">课程</a></li>
        <li><a href="/ranklist">排名</a></li>
        <% if (user) { %>
          <% if (user.is_admin) { %>
            <li><a href="/submissions">提交状态</a></li>
          <% } else { %>
            <li><a href="/submissions?submitter=<%= user.username %>">提交状态</a></li>
          <% } %>
          <li><a href="<%= syzoj.utils.makeUrl(['user', user.id, 'edit']) %>">设定</a></li>
        <% } %>
        <li><a href="/discussion/global">讨论</a></li>
        <% if (user && user.is_admin) { %>
          <li><a href="<%= syzoj.utils.makeUrl(['admin', 'info']) %>">管理</a>
        <% } %>
      </ul>
      <div class="rssbut" id="toggleWidth" title="更改窗口宽度">&lt;-&gt;</div>
    </div>
  </div>
  <div class="main_frame">
