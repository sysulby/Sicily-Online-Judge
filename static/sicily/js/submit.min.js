"use strict";$(function(){function a(){var G=$("#pid").val(),H=$("#cid").val();return(H||(H=0),1e3>G)?($("#problem_title").html(""),$("#submit_form input:submit").button("disable"),!1):($.post("action.php?act=CheckProblem",{pid:G,cid:H},function(I){$("#problem_title").html("<span id='ptitle'>"+I.status+"</span>");var J="show_problem.php?pid="+G;H&&(J+="&cid="+H),I.success?($("#submit_form input:submit").button("enable"),$("#ptitle").wrap("<a href=\""+J+"\"></a>")):$("#submit_form input:submit").button("disable")},"json"),!0)}function b(G){return Math.floor((Math.random()+0.5)*G)}function c(G){if(w=!0,$("#judge_box").dialog("close"),setTimeout(function(){$("#status_box").dialog("open")},500),e(),G.status in hintMsg?$("#status_info").text(hintMsg[G.status][0]):$("#status_info").text(G.status),$("#status_more_info").html(""),G.case_num){var H=parseInt(G.case_num);0<=H&&("Accepted"==G.status?$("#status_more_info").append("<p>Passed all "+H+" test cases</p>"):$("#status_more_info").append("<p>Failed at test case #"+(H+1)+"</p>"))}$("#status_info").removeClass("Accepted Wrong"),"Accepted"==G.status?($("#status_info").addClass("Accepted"),$("#status_more_info").append("<p>Run Time: "+G.run_time+" secs</p>").append("<p>Run Memory: "+G.run_memory+" KB</p>")):G.status in hintMsg&&($("#status_more_info").append("<p>"+hintMsg[G.status][1]+"</p>"),$("#status_info").addClass("Wrong")),$("#tabs").tabs("remove",1),"Compile Error"==G.status&&$.get("/process.php?act=ViewCE&sid="+G.sid,function(I){$("#status_more_info").append("<div class=\"ce-info\"><pre>"+I+"</pre></div>")})}function e(){y&&(clearInterval(y),y=null)}function f(G){G=Math.floor(G),0>G&&(G=0),100<G&&(G=100),$("#progressbar").progressbar("value",G),$("#progressbar_info").text(100-G+"% time left.")}function j(G){$("#judge_info").text(G.status),t=parseInt(G.case_num),0<=t?$("#testcase_info").text("Passed "+t+"test cases."):$("#testcase_info").text("Only single test case."),G.status!=p[0]||null!=y;for(var H=0;H<p.length;++H)if(p[H]==G.status)return!1;return!0}function k(G){return function(){$.post("action.php?act=QueryStatus",{sid:G},function(H,I){if("success"!=I&&(H={},H.success=!1,H.status=I),H.success&&!j(H)){var J=parseInt(H.queue_size);H.status==p[0]&&J++,0==J&&(J=1),x=b(500*J),setTimeout(k(G),x)}else c(H)},"json")}}function l(G,H){"success"!=H&&(G={},G.success=!1,G.status=H),y=null,x=0,G.success?($("#judge_info").text("Submit succeeded"),s=0,k(G.sid)()):c(G)}function n(){F=parseInt($("select[name=language]").val()),SetCookie("lang",F);var G=B[A[F-1]];z.getSession().setMode("ace/mode/"+G)}var p=["Judging","Waiting","Compiling","Running"],s,t,u,v,w,x,y,z,A=["c","cpp","pas"],B={c:"c_cpp",cpp:"c_cpp",pas:"pascal",java:"java"},C={autoOpen:!1,minWidth:500,resizable:!1,hide:{effect:"fade",duration:200},show:{effect:"fade",duration:200},beforeClose:w},F=GetCookie("lang");$("#submit_form input:submit").button(),$("#pid").change(a),$("#submit_form").submit(function(){w=!1,$("#status_box").dialog("isOpen")&&$("#status_box").dialog("close"),$("#judge_box").dialog("open"),f(0),$("#judge_info").text("Submitting your code to server.");var G=$("#pid").val(),H=$("#cid").val(),I=$("#language").val(),J=z.getValue();return H||(H=0),$.post("action.php?act=Submit",{pid:G,cid:H,language:I,source:J},l,"json"),!1}),$("#status_box").dialog({autoOpen:!1,minHeight:300,minWidth:500,hide:{effect:"fade",duration:200},show:{effect:"fade",duration:200},buttons:[{text:"Back to problem",click:function click(){var G=$("#cid").val(),H=$("#pid").val();G||(G=""),window.location="show_problem.php?pid="+H+"&cid="+G}},{text:"Back to problem list",click:function click(){var G=$("#cid").val();window.location=G?"contest_detail.php?cid="+G:"problem_list.php"}},{text:"OK",click:function click(){$(this).dialog("close")}}],create:function create(){console.log($(this).closest(".ui-dialog")),$(this).closest(".ui-dialog").find(".ui-button").addClass("button_blue")}}),$("#judge_box").dialog(C),$("#tabs").tabs({cache:!0}),$("#progressbar").progressbar({value:0}),a(),F=null==F?2:parseInt(F),$("select[name=language]").val(F).change(n),function(){ace.config.set("basePath","js/ace/src-noconflict"),z=ace.edit("source"),z.setTheme("ace/theme/chrome"),n()}()});
